{"ast":null,"code":"import _slicedToArray from\"C:/Users/lenovo/Desktop/CAB_RENTAL/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Col,Row,Divider,DatePicker,Checkbox,Modal}from\"antd\";import React,{useState,useEffect}from\"react\";import{useSelector,useDispatch}from\"react-redux\";import DefaultLayout from\"../components/DefaultLayout\";import Spinner from\"../components/Spinner\";import{getAllCars}from\"../redux/actions/carsActions\";import moment from\"moment\";import{bookCar}from\"../redux/actions/bookingActions\";import StripeCheckout from\"react-stripe-checkout\";import AOS from'aos';import'aos/dist/aos.css';// You can also use <link> for styles\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var RangePicker=DatePicker.RangePicker;function BookingCar(_ref){var match=_ref.match;var _useSelector=useSelector(function(state){return state.carsReducer;}),cars=_useSelector.cars;var _useSelector2=useSelector(function(state){return state.alertsReducer;}),loading=_useSelector2.loading;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),car=_useState2[0],setcar=_useState2[1];var dispatch=useDispatch();var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),from=_useState4[0],setFrom=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),to=_useState6[0],setTo=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),totalHours=_useState8[0],setTotalHours=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),driver=_useState10[0],setdriver=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),totalAmount=_useState12[0],setTotalAmount=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),showModal=_useState14[0],setShowModal=_useState14[1];useEffect(function(){if(cars.length==0){dispatch(getAllCars());}else{setcar(cars.find(function(o){return o._id==match.params.carid;}));}},[cars]);useEffect(function(){setTotalAmount(totalHours*car.rentPerHour);if(driver){setTotalAmount(totalAmount+30*totalHours);}},[driver,totalHours]);function selectTimeSlots(values){setFrom(moment(values[0]).format(\"MMM DD yyyy HH:mm\"));setTo(moment(values[1]).format(\"MMM DD yyyy HH:mm\"));setTotalHours(values[1].diff(values[0],\"hours\"));}function onToken(token){var reqObj={token:token,user:JSON.parse(localStorage.getItem(\"user\"))._id,car:car._id,totalHours:totalHours,totalAmount:totalAmount,driverRequired:driver,bookedTimeSlots:{from:from,to:to}};dispatch(bookCar(reqObj));}return/*#__PURE__*/_jsxs(DefaultLayout,{children:[loading&&/*#__PURE__*/_jsx(Spinner,{}),/*#__PURE__*/_jsxs(Row,{justify:\"center\",className:\"d-flex align-items-center\",style:{minHeight:\"90vh\"},children:[/*#__PURE__*/_jsx(Col,{lg:10,sm:24,xs:24,className:\"p-3\",children:/*#__PURE__*/_jsx(\"img\",{src:car.image,className:\"carimg2 bs1 w-100\",\"data-aos\":\"flip-left\",\"data-aos-duration\":\"1500\"})}),/*#__PURE__*/_jsxs(Col,{lg:10,sm:24,xs:24,className:\"text-right\",children:[/*#__PURE__*/_jsx(Divider,{type:\"horizontal\",dashed:true,children:\"Car Info\"}),/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:\"right\"},children:[/*#__PURE__*/_jsx(\"p\",{children:car.name}),/*#__PURE__*/_jsxs(\"p\",{children:[car.rentPerHour,\" Rent Per hour /-\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Fuel Type : \",car.fuelType]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Max Persons : \",car.capacity]})]}),/*#__PURE__*/_jsx(Divider,{type:\"horizontal\",dashed:true,children:\"Select Time Slots\"}),/*#__PURE__*/_jsx(RangePicker,{showTime:{format:\"HH:mm\"},format:\"MMM DD yyyy HH:mm\",onChange:selectTimeSlots}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{className:\"btn1 mt-2\",onClick:function onClick(){setShowModal(true);},children:\"See Booked Slots\"}),from&&to&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Total Hours : \",/*#__PURE__*/_jsx(\"b\",{children:totalHours})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Rent Per Hour : \",/*#__PURE__*/_jsx(\"b\",{children:car.rentPerHour})]}),/*#__PURE__*/_jsx(Checkbox,{onChange:function onChange(e){if(e.target.checked){setdriver(true);}else{setdriver(false);}},children:\"Driver Required\"}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Total Amount : \",totalAmount]}),/*#__PURE__*/_jsx(StripeCheckout,{shippingAddress:true,token:onToken,currency:\"inr\",amount:totalAmount*100,stripeKey:\"pk_test_51IYnC0SIR2AbPxU0TMStZwFUoaDZle9yXVygpVIzg36LdpO8aSG8B9j2C0AikiQw2YyCI8n4faFYQI5uG3Nk5EGQ00lCfjXYvZ\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn1\",children:\"Book Now\"})})]})]}),car.name&&/*#__PURE__*/_jsx(Modal,{visible:showModal,closable:false,footer:false,title:\"Booked time slots\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-2\",children:[car.bookedTimeSlots.map(function(slot){return/*#__PURE__*/_jsxs(\"button\",{className:\"btn1 mt-2\",children:[slot.from,\" - \",slot.to]});}),/*#__PURE__*/_jsx(\"div\",{className:\"text-right mt-5\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn1\",onClick:function onClick(){setShowModal(false);},children:\"CLOSE\"})})]})})]})]});}export default BookingCar;","map":{"version":3,"sources":["C:/Users/lenovo/Desktop/CAB_RENTAL/client/src/pages/BookingCar.js"],"names":["Col","Row","Divider","DatePicker","Checkbox","Modal","React","useState","useEffect","useSelector","useDispatch","DefaultLayout","Spinner","getAllCars","moment","bookCar","StripeCheckout","AOS","RangePicker","BookingCar","match","state","carsReducer","cars","alertsReducer","loading","car","setcar","dispatch","from","setFrom","to","setTo","totalHours","setTotalHours","driver","setdriver","totalAmount","setTotalAmount","showModal","setShowModal","length","find","o","_id","params","carid","rentPerHour","selectTimeSlots","values","format","diff","onToken","token","reqObj","user","JSON","parse","localStorage","getItem","driverRequired","bookedTimeSlots","minHeight","image","textAlign","name","fuelType","capacity","e","target","checked","map","slot"],"mappings":"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","sourcesContent":["import { Col, Row, Divider, DatePicker, Checkbox, Modal } from \"antd\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport DefaultLayout from \"../components/DefaultLayout\";\r\nimport Spinner from \"../components/Spinner\";\r\nimport { getAllCars } from \"../redux/actions/carsActions\";\r\nimport moment from \"moment\";\r\nimport { bookCar } from \"../redux/actions/bookingActions\";\r\nimport StripeCheckout from \"react-stripe-checkout\";\r\nimport AOS from 'aos';\r\n\r\nimport 'aos/dist/aos.css'; // You can also use <link> for styles\r\nconst { RangePicker } = DatePicker;\r\nfunction BookingCar({ match }) {\r\n  const { cars } = useSelector((state) => state.carsReducer);\r\n  const { loading } = useSelector((state) => state.alertsReducer);\r\n  const [car, setcar] = useState({});\r\n  const dispatch = useDispatch();\r\n  const [from, setFrom] = useState();\r\n  const [to, setTo] = useState();\r\n  const [totalHours, setTotalHours] = useState(0);\r\n  const [driver, setdriver] = useState(false);\r\n  const [totalAmount, setTotalAmount] = useState(0);\r\n  const [showModal, setShowModal] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (cars.length == 0) {\r\n      dispatch(getAllCars());\r\n    } else {\r\n      setcar(cars.find((o) => o._id == match.params.carid));\r\n    }\r\n  }, [cars]);\r\n\r\n  useEffect(() => {\r\n    setTotalAmount(totalHours * car.rentPerHour);\r\n    if (driver) {\r\n      setTotalAmount(totalAmount + 30 * totalHours);\r\n    }\r\n  }, [driver, totalHours]);\r\n\r\n  function selectTimeSlots(values) {\r\n    setFrom(moment(values[0]).format(\"MMM DD yyyy HH:mm\"));\r\n    setTo(moment(values[1]).format(\"MMM DD yyyy HH:mm\"));\r\n\r\n    setTotalHours(values[1].diff(values[0], \"hours\"));\r\n  }\r\n\r\n  \r\n\r\n  function onToken(token){\r\n    const reqObj = {\r\n        token,\r\n        user: JSON.parse(localStorage.getItem(\"user\"))._id,\r\n        car: car._id,\r\n        totalHours,\r\n        totalAmount,\r\n        driverRequired: driver,\r\n        bookedTimeSlots: {\r\n          from,\r\n          to,\r\n        },\r\n      };\r\n  \r\n      dispatch(bookCar(reqObj));\r\n  }\r\n\r\n  return (\r\n    <DefaultLayout>\r\n      {loading && <Spinner />}\r\n      <Row\r\n        justify=\"center\"\r\n        className=\"d-flex align-items-center\"\r\n        style={{ minHeight: \"90vh\" }}\r\n      >\r\n        <Col lg={10} sm={24} xs={24} className='p-3'>\r\n          <img src={car.image} className=\"carimg2 bs1 w-100\" data-aos='flip-left' data-aos-duration='1500'/>\r\n        </Col>\r\n\r\n        <Col lg={10} sm={24} xs={24} className=\"text-right\">\r\n          <Divider type=\"horizontal\" dashed>\r\n            Car Info\r\n          </Divider>\r\n          <div style={{ textAlign: \"right\" }}>\r\n            <p>{car.name}</p>\r\n            <p>{car.rentPerHour} Rent Per hour /-</p>\r\n            <p>Fuel Type : {car.fuelType}</p>\r\n            <p>Max Persons : {car.capacity}</p>\r\n          </div>\r\n\r\n          <Divider type=\"horizontal\" dashed>\r\n            Select Time Slots\r\n          </Divider>\r\n          <RangePicker\r\n            showTime={{ format: \"HH:mm\" }}\r\n            format=\"MMM DD yyyy HH:mm\"\r\n            onChange={selectTimeSlots}\r\n          />\r\n          <br />\r\n          <button\r\n            className=\"btn1 mt-2\"\r\n            onClick={() => {\r\n              setShowModal(true);\r\n            }}\r\n          >\r\n            See Booked Slots\r\n          </button>\r\n          {from && to && (\r\n            <div>\r\n              <p>\r\n                Total Hours : <b>{totalHours}</b>\r\n              </p>\r\n              <p>\r\n                Rent Per Hour : <b>{car.rentPerHour}</b>\r\n              </p>\r\n              <Checkbox\r\n                onChange={(e) => {\r\n                  if (e.target.checked) {\r\n                    setdriver(true);\r\n                  } else {\r\n                    setdriver(false);\r\n                  }\r\n                }}\r\n              >\r\n                Driver Required\r\n              </Checkbox>\r\n\r\n              <h3>Total Amount : {totalAmount}</h3>\r\n\r\n              <StripeCheckout\r\n                shippingAddress\r\n                token={onToken}\r\n                currency='inr'\r\n                amount={totalAmount * 100}\r\n                stripeKey=\"pk_test_51IYnC0SIR2AbPxU0TMStZwFUoaDZle9yXVygpVIzg36LdpO8aSG8B9j2C0AikiQw2YyCI8n4faFYQI5uG3Nk5EGQ00lCfjXYvZ\"\r\n              >\r\n                  <button className=\"btn1\">\r\n                Book Now\r\n              </button>\r\n              </StripeCheckout>\r\n\r\n              \r\n            </div>\r\n          )}\r\n        </Col>\r\n\r\n        {car.name && (\r\n          <Modal\r\n            visible={showModal}\r\n            closable={false}\r\n            footer={false}\r\n            title=\"Booked time slots\"\r\n          >\r\n            <div className=\"p-2\">\r\n              {car.bookedTimeSlots.map((slot) => {\r\n                return (\r\n                  <button className=\"btn1 mt-2\">\r\n                    {slot.from} - {slot.to}\r\n                  </button>\r\n                );\r\n              })}\r\n\r\n              <div className=\"text-right mt-5\">\r\n                <button\r\n                  className=\"btn1\"\r\n                  onClick={() => {\r\n                    setShowModal(false);\r\n                  }}\r\n                >\r\n                  CLOSE\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </Modal>\r\n        )}\r\n      </Row>\r\n    </DefaultLayout>\r\n  );\r\n}\r\n\r\nexport default BookingCar;\r\n"]},"metadata":{},"sourceType":"module"}